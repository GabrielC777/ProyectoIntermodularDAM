\doxysubsection{View\+Perfil\+View\+Model.\+cs}
\hypertarget{a00146_source}{}\label{a00146_source}\index{BetaProyecto/ViewModels/ViewPerfilViewModel.cs@{BetaProyecto/ViewModels/ViewPerfilViewModel.cs}}
\doxymbox{\hyperlink{a00146}{Ir a la documentación de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{a00146_source_l00001}00001\ \textcolor{keyword}{using\ }\doxymbox{\hyperlink{a00177}{BetaProyecto.Models}};}
\DoxyCodeLine{\Hypertarget{a00146_source_l00002}00002\ \textcolor{keyword}{using\ }\doxymbox{\hyperlink{a00179}{BetaProyecto.Singleton}};}
\DoxyCodeLine{\Hypertarget{a00146_source_l00003}00003\ \textcolor{keyword}{using\ }ReactiveUI;}
\DoxyCodeLine{\Hypertarget{a00146_source_l00004}00004\ \textcolor{keyword}{using\ }System;}
\DoxyCodeLine{\Hypertarget{a00146_source_l00005}00005\ \textcolor{keyword}{using\ }System.Collections.ObjectModel;}
\DoxyCodeLine{\Hypertarget{a00146_source_l00006}00006\ \textcolor{keyword}{using\ }System.Reactive;}
\DoxyCodeLine{\Hypertarget{a00146_source_l00007}00007\ \textcolor{keyword}{using\ }System.Threading;}
\DoxyCodeLine{\Hypertarget{a00146_source_l00008}00008\ \textcolor{keyword}{using\ }System.Threading.Tasks;}
\DoxyCodeLine{\Hypertarget{a00146_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00010}00010\ \textcolor{keyword}{namespace\ }\doxymbox{\hyperlink{a00180}{BetaProyecto.ViewModels}}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00011}00011\ \{}
\DoxyCodeLine{\Hypertarget{a00146_source_l00012}\doxymbox{\hyperlink{a00457}{00012}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{class\ }\doxymbox{\hyperlink{a00457_a85be38cbd0f5e15dcf2d370c23d30083}{ViewPerfilViewModel}}\ :\ \doxymbox{\hyperlink{a00453}{ViewModelBase}}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00013}00013\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{a00146_source_l00014}00014\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Bidings\ }}
\DoxyCodeLine{\Hypertarget{a00146_source_l00015}\doxymbox{\hyperlink{a00457_afdc0d9850f8be067d7a1c10be02725c9}{00015}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{string}\ \doxymbox{\hyperlink{a00457_afdc0d9850f8be067d7a1c10be02725c9}{\_nombreUsuario}};}
\DoxyCodeLine{\Hypertarget{a00146_source_l00016}\doxymbox{\hyperlink{a00457_a5d2f1ac6d77bba035913e8e90c007c24}{00016}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keywordtype}{string}\ \doxymbox{\hyperlink{a00457_a5d2f1ac6d77bba035913e8e90c007c24}{NombreUsuario}}\ \{\ \textcolor{keyword}{get}\ =>\ \doxymbox{\hyperlink{a00457_afdc0d9850f8be067d7a1c10be02725c9}{\_nombreUsuario}};\ \textcolor{keyword}{set}\ =>\ this.RaiseAndSetIfChanged(ref\ \doxymbox{\hyperlink{a00457_afdc0d9850f8be067d7a1c10be02725c9}{\_nombreUsuario}},\ value);\ \}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00018}\doxymbox{\hyperlink{a00457_acfc2f15d9f50e5485189631c1ffc1ce7}{00018}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{string}\ \doxymbox{\hyperlink{a00457_acfc2f15d9f50e5485189631c1ffc1ce7}{\_imagenPerfil}};}
\DoxyCodeLine{\Hypertarget{a00146_source_l00019}\doxymbox{\hyperlink{a00457_a7c90a9885d2e6c740f759024a73fa515}{00019}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keywordtype}{string}\ \doxymbox{\hyperlink{a00457_a7c90a9885d2e6c740f759024a73fa515}{ImagenPerfil}}\ \{\ \textcolor{keyword}{get}\ =>\ \doxymbox{\hyperlink{a00457_acfc2f15d9f50e5485189631c1ffc1ce7}{\_imagenPerfil}};\ \textcolor{keyword}{set}\ =>\ this.RaiseAndSetIfChanged(ref\ \doxymbox{\hyperlink{a00457_acfc2f15d9f50e5485189631c1ffc1ce7}{\_imagenPerfil}},\ value);\ \}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00021}\doxymbox{\hyperlink{a00457_aad50a59be3759bec93fb47f0ae5ccb19}{00021}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ ObservableCollection<ListaUsuarios>\ \doxymbox{\hyperlink{a00457_aad50a59be3759bec93fb47f0ae5ccb19}{\_secciones}};}
\DoxyCodeLine{\Hypertarget{a00146_source_l00022}\doxymbox{\hyperlink{a00457_afd899af6a120353b28a4a9effdc0d8d2}{00022}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ ObservableCollection<ListaUsuarios>\ \doxymbox{\hyperlink{a00457_afd899af6a120353b28a4a9effdc0d8d2}{Secciones}}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00023}00023\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{a00146_source_l00024}00024\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{get}\ =>\ \doxymbox{\hyperlink{a00457_aad50a59be3759bec93fb47f0ae5ccb19}{\_secciones}};}
\DoxyCodeLine{\Hypertarget{a00146_source_l00025}00025\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{set}\ =>\ this.RaiseAndSetIfChanged(ref\ \doxymbox{\hyperlink{a00457_aad50a59be3759bec93fb47f0ae5ccb19}{\_secciones}},\ value);}
\DoxyCodeLine{\Hypertarget{a00146_source_l00026}00026\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00027}00027\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Comandos\ Reactive\ }}
\DoxyCodeLine{\Hypertarget{a00146_source_l00028}\doxymbox{\hyperlink{a00457_a4909170503aec3531bcb099047fdf328}{00028}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ ReactiveCommand<Unit,\ Unit>\ \doxymbox{\hyperlink{a00457_a4909170503aec3531bcb099047fdf328}{BtnRefrescar}}\ \{\ \textcolor{keyword}{get};\ \}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00030}\doxymbox{\hyperlink{a00457_a85be38cbd0f5e15dcf2d370c23d30083}{00030}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \doxymbox{\hyperlink{a00457_a85be38cbd0f5e15dcf2d370c23d30083}{ViewPerfilViewModel}}()}
\DoxyCodeLine{\Hypertarget{a00146_source_l00031}00031\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{a00146_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Inicializamos\ listas}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{a00457_afd899af6a120353b28a4a9effdc0d8d2}{Secciones}}\ =\ \textcolor{keyword}{new}\ ObservableCollection<ListaUsuarios>();}
\DoxyCodeLine{\Hypertarget{a00146_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Configuramos\ comandos\ reactive\ }}
\DoxyCodeLine{\Hypertarget{a00146_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{a00457_a4909170503aec3531bcb099047fdf328}{BtnRefrescar}}\ =\ ReactiveCommand.CreateFromTask(async\ ()\ =>\ await\ \doxymbox{\hyperlink{a00457_a7eeead264f517c6f5b68aebae0b8d549}{CargarDatos}}());\ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \_\ =\ \doxymbox{\hyperlink{a00457_a7eeead264f517c6f5b68aebae0b8d549}{CargarDatos}}();\ \textcolor{comment}{//\ Cargamos\ los\ datos\ en\ segundo\ plano}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00039}00039\ \ \ \ \ \ \ \ \ \}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00040}00040\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ <summary>}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00041}00041\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ Recupera\ y\ organiza\ de\ forma\ asíncrona\ la\ información\ del\ perfil,\ artistas\ sugeridos\ y\ usuarios\ seguidos.}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00042}00042\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ </summary>}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00043}00043\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ <remarks>}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00044}00044\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ Este\ método\ gestiona\ la\ carga\ de\ la\ red\ social\ del\ usuario\ mediante\ los\ siguientes\ pasos:}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00045}00045\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ <list\ type="{}number"{}>}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00046}00046\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ <item><b>Inicialización:</b>\ Carga\ la\ identidad\ básica\ (nombre\ y\ foto)\ desde\ <see\ cref="{}GlobalData.Instance"{}/>.</item>}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00047}00047\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ <item><b>Carga\ Paralela:</b>\ Ejecuta\ simultáneamente\ las\ peticiones\ a\ MongoDB\ para\ obtener\ los\ perfiles\ seguidos\ y\ el\ catálogo\ global\ de\ usuarios\ mediante\ <see\ cref="{}Task.WhenAll"{}/>.</item>}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00048}00048\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ <item><b>Categorización:</b>\ Estructura\ los\ resultados\ en\ secciones\ diferenciadas\ ("{}Descubre\ Artistas"{}\ y\ "{}Siguiendo"{})\ utilizando\ claves\ de\ traducción\ para\ los\ encabezados.</item>}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00049}00049\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ <item><b>Asignación:</b>\ Actualiza\ la\ propiedad\ <see\ cref="{}Secciones"{}/>,\ lo\ que\ dispara\ la\ actualización\ de\ los\ controles\ agrupados\ en\ la\ interfaz.</item>}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00050}00050\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ </list>}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00051}00051\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ Cualquier\ fallo\ durante\ la\ consulta\ se\ registra\ en\ la\ consola\ de\ depuración\ para\ evitar\ el\ colapso\ de\ la\ vista.}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00052}00052\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ </remarks>}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00053}00053\ \textcolor{comment}{\ \ \ \ \ \ \ \ ///\ <returns>Una\ tarea\ que\ representa\ la\ operación\ de\ carga\ y\ estructuración\ asíncrona.</returns>}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00054}\doxymbox{\hyperlink{a00457_a7eeead264f517c6f5b68aebae0b8d549}{00054}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ async\ Task\ \doxymbox{\hyperlink{a00457_a7eeead264f517c6f5b68aebae0b8d549}{CargarDatos}}()}
\DoxyCodeLine{\Hypertarget{a00146_source_l00055}00055\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{a00146_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{a00146_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Carga\ datos\ básicos}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{a00457_a5d2f1ac6d77bba035913e8e90c007c24}{NombreUsuario}}\ =\ GlobalData.Instance.UsernameGD\ ??\ \textcolor{stringliteral}{"{}Usuario"{}};}
\DoxyCodeLine{\Hypertarget{a00146_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{a00457_a7c90a9885d2e6c740f759024a73fa515}{ImagenPerfil}}\ =\ GlobalData.Instance.UrlFotoPerfilGD\ ??\ \textcolor{stringliteral}{"{}https://i.ibb.co/dbQSrpB/Perfil.png"{}};}
\DoxyCodeLine{\Hypertarget{a00146_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Carga\ listas\ en\ paralelo}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ listaIds\ =\ \doxymbox{\hyperlink{a00349}{GlobalData}}.\doxymbox{\hyperlink{a00349_a9e2c3551655ac39eac433318a7e87ba4}{Instance}}.\doxymbox{\hyperlink{a00349_a68c2f59413aaa6f436a33384fdaaefc0}{SeguidoresGD}};}
\DoxyCodeLine{\Hypertarget{a00146_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ taskSeguidores\ =\ \doxymbox{\hyperlink{a00353}{MongoClientSingleton}}.\doxymbox{\hyperlink{a00353_ad0067cc765141c80b254d1a39395f529}{Instance}}.\doxymbox{\hyperlink{a00353_a275ea6d123352f803782b0ff26216fc6}{Cliente}}.ObtenerUsuariosPorListaIds(listaIds);}
\DoxyCodeLine{\Hypertarget{a00146_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ taskTodos\ =\ \doxymbox{\hyperlink{a00353}{MongoClientSingleton}}.\doxymbox{\hyperlink{a00353_ad0067cc765141c80b254d1a39395f529}{Instance}}.\doxymbox{\hyperlink{a00353_a275ea6d123352f803782b0ff26216fc6}{Cliente}}.ObtenerTodosLosUsuarios();}
\DoxyCodeLine{\Hypertarget{a00146_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ Task.WhenAll(taskSeguidores,\ taskTodos);}
\DoxyCodeLine{\Hypertarget{a00146_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ listaSecciones\ =\ \textcolor{keyword}{new}\ ObservableCollection<ListaUsuarios>();}
\DoxyCodeLine{\Hypertarget{a00146_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Sección\ 1:\ Descubre\ Artistas}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ listaSecciones.Add(\textcolor{keyword}{new}\ \doxymbox{\hyperlink{a00277}{ListaUsuarios}}(\textcolor{stringliteral}{"{}Perfil\_SecDescubre"{}},\ \textcolor{keyword}{new}\ ObservableCollection<Usuarios>(taskTodos.Result)));}
\DoxyCodeLine{\Hypertarget{a00146_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Sección\ 2:\ Siguiendo}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ listaSecciones.Add(\textcolor{keyword}{new}\ \doxymbox{\hyperlink{a00277}{ListaUsuarios}}(\textcolor{stringliteral}{"{}Perfil\_SecSiguiendo"{}},\textcolor{keyword}{new}\ ObservableCollection<Usuarios>(taskSeguidores.Result)));}
\DoxyCodeLine{\Hypertarget{a00146_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{a00146_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Asignamos\ a\ la\ propiedad\ pública}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{a00457_afd899af6a120353b28a4a9effdc0d8d2}{Secciones}}\ =\ listaSecciones;}
\DoxyCodeLine{\Hypertarget{a00146_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (Exception\ ex)}
\DoxyCodeLine{\Hypertarget{a00146_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{a00146_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ System.Diagnostics.Debug.WriteLine(\textcolor{stringliteral}{"{}Error\ cargando\ perfil:\ "{}}\ +\ ex.Message);}
\DoxyCodeLine{\Hypertarget{a00146_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00084}00084\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00085}00085\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a00146_source_l00086}00086\ \}}

\end{DoxyCode}
